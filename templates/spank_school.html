{% extends "base.html" %}

{% block title %}üß† SPANKKS SKOOL - DIY Learning Hub{% endblock %}
{% block extra_head %}
  <meta name="description" content="Learn DIY construction and repair skills with SPANKKS SKOOL. Interactive courses with SPANK Buck rewards.">
  <meta name="keywords" content="DIY construction, repair courses, SPANKKS SKOOL, construction education">
{% endblock %}


{% block head %}
<style>
    .hero-section {
        background: linear-gradient(135deg, rgba(255, 107, 53, 0.8), rgba(247, 147, 30, 0.8)), url('/static/images/spank-school-hero.png');
        background-size: cover;
        background-position: center;
        color: white;
        padding: 120px 0 40px;
        margin-top: 0;
        min-height: 30vh;
        position: relative;
        z-index: 1;
    }
    
    @media (max-width: 768px) {
        .hero-section {
            padding: 100px 0 30px;
            min-height: 25vh;
        }
        
        .hero-section h1 {
            font-size: 2rem !important;
        }
        
        .hero-section .lead {
            font-size: 1rem;
        }
        
        .points-display {
            justify-content: center;
            margin-top: 1rem;
        }
        
        .points-display img {
            height: 50px !important;
        }
        
        .quiz-reward-badge img {
            height: 80px !important;
        }
        
        .course-card {
            margin-bottom: 1rem;
        }
        
        .btn-lg {
            font-size: 1rem;
            padding: 0.75rem 1.5rem;
        }
        
        .category-header h3 {
            font-size: 1.5rem;
        }
        
        .modal-content {
            margin: 1rem;
        }
        
        .lesson-content img {
            max-width: 100% !important;
            height: auto !important;
        }
        
        .quiz-container {
            padding: 1rem;
        }
        
        .quiz-option {
            padding: 1rem;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
            min-height: 48px;
            display: flex;
            align-items: center;
        }
        
        .problem-solver-step {
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .feature-icon {
            margin-bottom: 1rem;
        }
        
        .feature-icon i {
            font-size: 2rem;
        }
        
        .col-md-3 {
            margin-bottom: 2rem !important;
        }
        
        .display-6 {
            font-size: 2rem !important;
        }
        
        .btn-group-vertical .btn {
            margin-bottom: 0.5rem;
        }
    }
    
    .course-card {
        transition: all 0.3s ease;
        border: none;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        height: 100%;
    }
    
    .course-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .difficulty-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 2;
    }
    
    .reward-badge {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        font-size: 0.75rem;
        padding: 4px 12px;
        border-radius: 15px;
        font-weight: bold;
    }
    
    .course-stats {
        font-size: 0.85rem;
        color: #6c757d;
    }
    
    .feature-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        margin: 0 auto 20px;
    }
    
    .video-badge {
        background: #dc3545;
        color: white;
        font-size: 0.75rem;
        padding: 2px 8px;
        border-radius: 12px;
        margin-left: 8px;
    }
    
    .category-header {
        background: linear-gradient(135deg, #343a40, #495057);
        color: white;
        border-radius: 10px 10px 0 0;
        padding: 20px;
        margin-bottom: 0;
    }
    
    .category-content {
        background: #f8f9fa;
        border-radius: 0 0 10px 10px;
        padding: 25px;
    }
    
    .points-display {
        background: linear-gradient(135deg, #ffc107, #ff8f00);
        color: #212529;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: bold;
        box-shadow: 0 2px 8px rgba(255,193,7,0.3);
    }
    
    .bg-gradient-warning {
        background: linear-gradient(135deg, #ffc107, #ffca2c) !important;
    }
    
    .action-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: none;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        min-height: 200px;
    }
    
    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    /* Mobile Optimizations */
    @media (max-width: 768px) {
        .hero-section {
            padding: 2rem 0 !important;
        }
        
        .display-4 {
            font-size: 2.5rem !important;
        }
        
        .action-card {
            min-height: 180px;
            margin-bottom: 1rem;
        }
        
        .action-card .btn {
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .action-card .d-flex {
            flex-direction: column;
            align-items: center !important;
            text-align: center;
        }
        
        .spank-character-mobile {
            max-height: 250px !important;
            margin: 1rem auto !important;
            display: block !important;
        }
        
        .mobile-center {
            text-align: center !important;
        }
        
        .course-card {
            margin-bottom: 1.5rem;
        }
        
        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 1.1rem;
        }
    }
    
    /* Desktop Optimizations */
    @media (min-width: 1200px) {
        .container-fluid {
            max-width: 1400px;
        }
        
        .action-card {
            min-height: 220px;
        }
        
        .display-4 {
            font-size: 3.5rem;
        }
    }
    
    /* Touch Device Optimizations */
    @media (hover: none) {
        .action-card:hover {
            transform: none;
        }
        
        .action-card:active {
            transform: scale(0.98);
        }
        
        .btn {
            min-height: 48px; /* Touch target size */
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Combined Hero and Quiz Section -->
<section class="hero-section py-5 bg-gradient-warning">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col-lg-8 order-2 order-lg-1">
                <div class="ps-3 ps-lg-5">
                    <h1 class="display-4 fw-bold mb-3 text-dark mobile-center">
                        üß† Welcome to SPANKKS SKOOL
                    </h1>
                    <p class="lead mb-4 text-dark mobile-center">
                        Master DIY repairs with professional guidance from Hawaii's trusted handyman experts.
                    </p>
                    
                    <!-- Combined Action Cards -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-6 col-12">
                            <div class="action-card bg-dark text-warning p-3 p-md-4 rounded-3 h-100">
                                <h5 class="fw-bold mb-2">üéì Monthly Knowledge Quiz</h5>
                                <p class="mb-3 small">Answer 4/5 questions correctly for $5 SPANK Bucks!</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <button class="btn btn-warning btn-lg" onclick="startKnowledgeQuiz()">
                                        <i class="fas fa-brain me-2"></i>Take Quiz
                                    </button>
                                    <img src="{{ url_for('static', filename='images/spank-buck-5.png') }}" alt="$5 SPANK Buck" style="height: 45px;">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-12">
                            <div class="action-card bg-primary text-white p-3 p-md-4 rounded-3 h-100">
                                <h5 class="fw-bold mb-2">üìö Learn DIY Skills</h5>
                                <p class="mb-3 small">Complete courses and earn $5 SPANK Bucks per course!</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <button class="btn btn-warning btn-lg" onclick="scrollToCourses()">
                                        <i class="fas fa-play me-2"></i>Start Learning
                                    </button>
                                    <img src="{{ url_for('static', filename='images/spank-buck-5.png') }}" alt="$5 SPANK Buck" style="height: 45px;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Problem Solver Button -->
                    <div class="text-center text-lg-start">
                        <button class="btn btn-outline-dark btn-lg px-4" onclick="showProblemSolver()">
                            <i class="fas fa-tools me-2"></i>Problem Solver
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 order-1 order-lg-2 text-center text-lg-end mt-3 mt-lg-0 p-0">
                <img src="{{ url_for('static', filename='images/spank-school-character.png') }}" 
                     alt="SPANK Mascot" class="img-fluid spank-character-mobile d-lg-block" 
                     style="max-height: 400px; width: auto; margin-right: -15px;">
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="py-5" style="background: linear-gradient(rgba(248, 249, 250, 0.9), rgba(248, 249, 250, 0.9)), url('/static/images/spankks-logo-new.png'); background-size: contain; background-repeat: no-repeat; background-position: center; background-attachment: fixed;">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-3 mb-4">
                <div class="feature-icon">
                    <i class="fas fa-video"></i>
                </div>
                <h5>Video Tutorials</h5>
                <p class="text-muted">Step-by-step video guides with professional tips</p>
            </div>
            <div class="col-md-3 mb-4">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h5>Interactive Learning</h5>
                <p class="text-muted">Quizzes, challenges, and hands-on practice</p>
            </div>
            <div class="col-md-3 mb-4">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h5>Safety First</h5>
                <p class="text-muted">Professional safety guidance for every project</p>
            </div>
            <div class="col-md-3 mb-4">
                <div class="feature-icon">
                    <i class="fas fa-award"></i>
                </div>
                <h5>Earn SPANK Bucks</h5>
                <p class="text-muted">Complete courses and earn $5 SPANK Bucks</p>
            </div>
        </div>
    </div>
</section>

<!-- Course Categories -->
<section class="py-5" id="courses">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">Choose Your Learning Path</h2>
            <p class="lead text-muted">From beginner basics to intermediate repairs</p>
        </div>

        <!-- Basics Everyone Should Know -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="category-header">
                    <h3 class="mb-0"><i class="fas fa-tools me-3"></i>üß∞ Basics Everyone Should Know</h3>
                </div>
                <div class="category-content">
                    <div class="row">
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">
                                        Toolbelt Basics
                                        <span class="video-badge">VISUAL</span>
                                    </h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>3 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Essential tools every homeowner needs and how to organize them for maximum efficiency.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('toolbelt')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">
                                        Hang a Picture
                                        <span class="video-badge">VISUAL</span>
                                    </h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>2 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Perfect picture hanging with proper anchors, leveling, and wall protection techniques.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('picture')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">Squeaky Door Fix</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>2 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Three safe methods to unclog drains without chemicals or damage to your pipes.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('drain')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Electrical Courses -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="category-header">
                    <h3 class="mb-0"><i class="fas fa-bolt me-3"></i>Electrical Safety</h3>
                </div>
                <div class="category-content">
                    <div class="row">
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-warning text-dark">Intermediate</span>
                                <div class="card-body">
                                    <h5 class="card-title">Replace an Outlet</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>3 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Safely replace electrical outlets with proper power shutoff and wiring techniques.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('outlet')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-warning text-dark">Intermediate</span>
                                <div class="card-body">
                                    <h5 class="card-title">Install a Light Switch</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>2 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Learn switch wiring basics and safe installation techniques.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('lightswitch')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">Circuit Breaker Basics</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-list-ol me-1"></i>3 lessons ‚Ä¢ 
                                        <i class="fas fa-images me-1"></i>Step-by-step photos
                                    </p>
                                    <p class="card-text">Understand your electrical panel and when to call professionals.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('breaker')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Improvement Courses -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="category-header">
                    <h3 class="mb-0"><i class="fas fa-home me-3"></i>Home Improvement</h3>
                </div>
                <div class="category-content">
                    <div class="row">
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">Patch Drywall</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-clock me-1"></i>15 min ‚Ä¢ 
                                        <i class="fas fa-list-ol me-1"></i>4 lessons
                                    </p>
                                    <p class="card-text">Fix holes and damage in drywall with professional techniques.</p>
                                    <div class="progress-indicator mb-3">
                                        <div class="progress-fill" style="width: 0%"></div>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('drywall')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-success">Beginner</span>
                                <div class="card-body">
                                    <h5 class="card-title">Touch-Up Paint</h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-clock me-1"></i>8 min ‚Ä¢ 
                                        <i class="fas fa-list-ol me-1"></i>3 lessons
                                    </p>
                                    <p class="card-text">Color matching secrets and professional touch-up techniques.</p>
                                    <div class="progress-indicator mb-3">
                                        <div class="progress-fill" style="width: 0%"></div>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('touchup')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100 position-relative">
                                <span class="difficulty-badge badge bg-info">Renovation</span>
                                <div class="card-body">
                                    <h5 class="card-title">
                                        Smart Home Upgrades
                                        <span class="pro-badge">RENO</span>
                                    </h5>
                                    <p class="course-stats mb-3">
                                        <i class="fas fa-clock me-1"></i>20 min ‚Ä¢ 
                                        <i class="fas fa-list-ol me-1"></i>4 lessons
                                    </p>
                                    <p class="card-text">Smart options for kitchen & bath renovations. Plan ahead with Spankks for smart-ready wiring.</p>
                                    <div class="mb-3">
                                        <span class="reward-badge">
                                            <i class="fas fa-dollar-sign me-1"></i>Earn $5 SPANK Bucks + Bonus
                                        </span>
                                    </div>
                                    <button class="btn btn-primary w-100" onclick="startCourse('smarthome')">
                                        <i class="fas fa-play me-2"></i>Start Course
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Tools Section -->
        <div class="row">
            <div class="col-12">
                <div class="category-header">
                    <h3 class="mb-0"><i class="fas fa-tools me-3"></i>Interactive Learning Tools</h3>
                </div>
                <div class="category-content">
                    <div class="row">
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100">
                                <div class="card-body text-center">
                                    <div class="feature-icon mb-3">
                                        <i class="fas fa-search"></i>
                                    </div>
                                    <h5 class="card-title">Problem Solver</h5>
                                    <p class="card-text">Step-by-step troubleshooting for common home issues</p>
                                    <button class="btn btn-outline-primary w-100" onclick="startTroubleshooter()">
                                        <i class="fas fa-cogs me-2"></i>Start Solver
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100">
                                <div class="card-body text-center">
                                    <div class="feature-icon mb-3">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <h5 class="card-title">Knowledge Quiz</h5>
                                    <p class="card-text">Test your DIY knowledge and earn $5 SPANK Bucks</p>
                                    <button class="btn btn-outline-primary w-100" onclick="startQuiz()">
                                        <i class="fas fa-question-circle me-2"></i>Take Quiz
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card course-card h-100">
                                <div class="card-body text-center">
                                    <div class="feature-icon mb-3">
                                        <i class="fas fa-video"></i>
                                    </div>
                                    <h5 class="card-title">Live Q&A</h5>
                                    <p class="card-text">Join weekly live sessions with SPANK experts</p>
                                    <button class="btn btn-outline-primary w-100" onclick="joinLiveSession()">
                                        <i class="fas fa-users me-2"></i>Join Session
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="py-5 bg-dark text-white">
    <div class="container text-center">
        <h2 class="mb-4">Need Professional Help?</h2>
        <p class="lead mb-4">Some repairs are best left to the experts. SPANK is here when you need us.</p>
        <div class="d-flex flex-wrap justify-content-center gap-3">
            <a href="{{ url_for('consultation') }}" class="btn btn-warning btn-lg px-4">
                <i class="fas fa-calendar-check me-2"></i>Book Free Consultation
            </a>
            <a href="tel:(808)778-9132" class="btn btn-outline-light btn-lg px-4">
                <i class="fas fa-phone me-2"></i>Call (808) 778-9132
            </a>
        </div>
    </div>
</section>

<!-- Course Modal -->
<div class="modal fade" id="courseModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="courseModalTitle">Course Lesson</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="courseModalBody">
                <!-- Course content will be loaded here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="nextLessonBtn">Next Lesson</button>
            </div>
        </div>
    </div>
</div>

<script>
// Course data structure
const courses = {
    toolbelt: {
        title: "Toolbelt Basics",
        level: "Beginner",
        duration: "30-40 minutes",
        reward: "$5 SPANK Bucks",
        lessons: [
            {
                title: "Know Your Tools",
                image: "/static/images/toolbelt-basics.png",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="/static/images/toolbelt-basics.png" class="img-fluid rounded" alt="Essential Hand Tools Layout">
                    </div>
                    <h6>üéØ Objective: Identify the core tools used in home maintenance and understand their function</h6>
                    
                    <h6>üõ†Ô∏è Essential Tools Visual Guide:</h6>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2"><strong>üî® Claw Hammer</strong> - Driving nails & removing them</li>
                                <li class="mb-2"><strong>üîß Adjustable Wrench</strong> - Tightening/loosening bolts</li>
                                <li class="mb-2"><strong>ü™ö Utility Knife</strong> - Cutting materials safely</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2"><strong>ü™ö Needle-nose Pliers</strong> - Precision gripping</li>
                                <li class="mb-2"><strong>ü™ö Slip-joint Pliers</strong> - General gripping tasks</li>
                                <li class="mb-2"><strong>ü™ö Screwdrivers</strong> - Phillips & flathead</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6><i class="fas fa-mouse-pointer me-2"></i>Interactive Activity:</h6>
                        <p class="mb-0">Match each tool to its primary task below!</p>
                    </div>
                    
                    <div class="tool-matching-game mb-4" id="toolMatchGame1">
                        <div class="row">
                            <div class="col-6">
                                <h6>Tools:</h6>
                                <div class="tool-items">
                                    <div class="tool-item" draggable="true" data-tool="hammer">üî® Hammer</div>
                                    <div class="tool-item" draggable="true" data-tool="wrench">üîß Wrench</div>
                                    <div class="tool-item" draggable="true" data-tool="screwdriver">ü™ö Screwdriver</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <h6>Tasks:</h6>
                                <div class="task-zones">
                                    <div class="task-zone" data-task="hammer">Remove a nail</div>
                                    <div class="task-zone" data-task="wrench">Tighten a bolt</div>
                                    <div class="task-zone" data-task="screwdriver">Install a screw</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Checkpoint Quiz:</h6>
                        <p class="mb-2">Which tool is best for removing nails?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-1', 'correct', 'Correct! The claw end of a hammer grips and pulls nails out.')">A) Claw hammer</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-1', 'wrong', 'Pliers can grip nails but don\\'t have the leverage of a hammer.')">B) Pliers</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-1', 'wrong', 'Screwdrivers are for screws, not nails.')">C) Screwdriver</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('tool-quiz-1', 'wrong', 'A utility knife cuts materials, not remove nails.')">D) Utility knife</button>
                        </div>
                        <div id="tool-quiz-1" class="mt-2" style="display: none;"></div>
                    </div>
                `
            },
            {
                title: "Start with the Basics",
                image: "/static/images/toolbelt-basics-2.png",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="/static/images/toolbelt-basics-2.png" class="img-fluid rounded" alt="Toolbelt Organization Steps">
                    </div>
                    <h6>üéØ Objective: Organize a minimalist starter toolbelt for common household tasks</h6>
                    
                    <h6>üì¶ Smart Toolbelt Setup:</h6>
                    <div class="step-by-step mb-4">
                        <div class="step mb-3">
                            <span class="step-number">1</span>
                            <strong>Empty Pouch Overview</strong> - Start with clean, organized pouches
                        </div>
                        <div class="step mb-3">
                            <span class="step-number">2</span>
                            <strong>Load Hammer & Pliers</strong> - Heavy tools on dominant side
                        </div>
                        <div class="step mb-3">
                            <span class="step-number">3</span>
                            <strong>Position Screwdrivers</strong> - Easy reach without bending
                        </div>
                        <div class="step mb-3">
                            <span class="step-number">4</span>
                            <strong>Balance Check</strong> - Distribute weight evenly
                        </div>
                    </div>
                    
                    <div class="alert alert-warning">
                        <strong>üí° Key Rule:</strong> Only carry what you need - overloading slows you down!
                    </div>
                    
                    <div class="alert alert-info">
                        <h6><i class="fas fa-puzzle-piece me-2"></i>Interactive Activity:</h6>
                        <p class="mb-0">Pack a toolbelt with only 6 slots available. Choose wisely!</p>
                    </div>
                    
                    <div class="toolbelt-simulator mb-4" id="toolbeltSim">
                        <h6>Available Tools:</h6>
                        <div class="available-tools mb-3">
                            <div class="tool-choice" data-tool="hammer">üî® Hammer</div>
                            <div class="tool-choice" data-tool="tape">üìè Tape Measure</div>
                            <div class="tool-choice" data-tool="screwdriver1">ü™ö Phillips Screwdriver</div>
                            <div class="tool-choice" data-tool="screwdriver2">ü™ö Flathead Screwdriver</div>
                            <div class="tool-choice" data-tool="pliers">üîß Pliers</div>
                            <div class="tool-choice" data-tool="level">üìê Level</div>
                            <div class="tool-choice" data-tool="knife">üî™ Utility Knife</div>
                            <div class="tool-choice" data-tool="wrench">üîß Wrench</div>
                        </div>
                        <h6>Your Toolbelt (6 slots):</h6>
                        <div class="toolbelt-slots">
                            <div class="slot empty" data-slot="1">Slot 1</div>
                            <div class="slot empty" data-slot="2">Slot 2</div>
                            <div class="slot empty" data-slot="3">Slot 3</div>
                            <div class="slot empty" data-slot="4">Slot 4</div>
                            <div class="slot empty" data-slot="5">Slot 5</div>
                            <div class="slot empty" data-slot="6">Slot 6</div>
                        </div>
                    </div>
                    
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Checkpoint Quiz:</h6>
                        <p class="mb-2">True or False: You should carry all tools you own in your toolbelt.</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-2', 'wrong', 'False! Carrying too many tools creates weight and balance problems.')">A) True</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('tool-quiz-2', 'correct', 'Correct! Only carry essential tools for the specific job.')">B) False</button>
                        </div>
                        <div id="tool-quiz-2" class="mt-2" style="display: none;"></div>
                    </div>
                `
            },
            {
                title: "Keep Things Handy",
                image: "/static/images/toolbelt-basics-3.png",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="/static/images/toolbelt-basics-3.png" class="img-fluid rounded" alt="Efficient Toolbox Organization">
                    </div>
                    <h6>üéØ Objective: Use a toolbox system for tool storage and transportation</h6>
                    
                    <h6>üì¶ Toolbox Types & Layout Tips:</h6>
                    <div class="toolbox-types mb-4">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <div class="toolbox-type p-3 border rounded">
                                    <h6>üß≥ Hard Case</h6>
                                    <p class="small mb-0">Portable, protected storage for smaller jobs</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="toolbox-type p-3 border rounded">
                                    <h6>üõû Rolling Box</h6>
                                    <p class="small mb-0">Mobile storage for larger tool collections</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="toolbox-type p-3 border rounded">
                                    <h6>üß© Modular Inserts</h6>
                                    <p class="small mb-0">Customizable organization systems</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout-principle mb-4">
                        <h6>üéØ Golden Rule: Top Tray for Daily Use Tools</h6>
                        <p>Keep your most-used tools in the top tray or easily accessible compartments.</p>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6><i class="fas fa-sort me-2"></i>Interactive Activity:</h6>
                        <p class="mb-0">Organize this messy toolbox! Click and drag to create an efficient layout.</p>
                    </div>
                    
                    <div class="toolbox-organizer mb-4" id="toolboxOrganizer">
                        <div class="row">
                            <div class="col-6">
                                <h6>Disorganized Box:</h6>
                                <div class="messy-box">
                                    <div class="scattered-tool" data-tool="hammer">üî®</div>
                                    <div class="scattered-tool" data-tool="screws">üî©</div>
                                    <div class="scattered-tool" data-tool="tape">üìè</div>
                                    <div class="scattered-tool" data-tool="pliers">üîß</div>
                                    <div class="scattered-tool" data-tool="level">üìê</div>
                                    <div class="scattered-tool" data-tool="nails">üìé</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <h6>Organized Layout:</h6>
                                <div class="organized-box">
                                    <div class="top-tray">
                                        <label>Top Tray (Daily Use)</label>
                                        <div class="tray-zone" data-category="daily"></div>
                                    </div>
                                    <div class="bottom-section">
                                        <label>Bottom (Hardware & Storage)</label>
                                        <div class="tray-zone" data-category="storage"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Checkpoint Quiz:</h6>
                        <p class="mb-2">Which toolbox layout is most efficient?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-3', 'wrong', 'Mixing tools randomly makes them hard to find quickly.')">A) All tools mixed together</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('tool-quiz-3', 'correct', 'Correct! Grouping by use and putting daily tools on top saves time.')">B) Daily tools on top, grouped by type</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('tool-quiz-3', 'wrong', 'Size-based organization doesn\\'t consider how often you use tools.')">C) Largest tools first</button>
                        </div>
                        <div id="tool-quiz-3" class="mt-2" style="display: none;"></div>
                    </div>
                    
                    <div class="completion-criteria mt-4">
                        <h6>üéâ Course Completion Criteria:</h6>
                        <ul class="list-unstyled">
                            <li>‚úÖ Pass all 3 checkpoint quizzes</li>
                            <li>‚úÖ Complete all 3 interactive activities</li>
                            <li>‚úÖ Spend at least 10 minutes per lesson</li>
                        </ul>
                        <div class="alert alert-success">
                            <strong>üéÅ Upon Completion:</strong> Earn $5 SPANK Bucks and unlock "Hang a Picture" lesson!
                        </div>
                    </div>
                `
            }
        ]
    },
    faucet: {
        title: "Fix a Leaky Faucet",
        level: "Beginner",
        lessons: [
            {
                title: "Know Your Faucet",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSIxMDAiIHdpZHRoPSIzMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjZGVlMmU2IiByeD0iMTAiLz48Y2lyY2xlIGN4PSIzMDAiIGN5PSIxNTAiIHI9IjIwIiBmaWxsPSIjMDA3YmZmIi8+PHRleHQgeD0iMjAwIiB5PSIyNTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzM0M2E0MCI+RmF1Y2V0IFR5cGVzICYgUGFydHM8L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSIxMDAiIHdpZHRoPSIzMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjZGVlMmU2IiByeD0iMTAiLz48Y2lyY2xlIGN4PSIzMDAiIGN5PSIxNTAiIHI9IjIwIiBmaWxsPSIjMDA3YmZmIi8+PHRleHQgeD0iMjAwIiB5PSIyNTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzM0M2E0MCI+RmF1Y2V0IFR5cGVzICYgUGFydHM8L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Faucet Types and Parts">
                    </div>
                    <h6>üéØ Goal: Identify faucet type and leak source</h6>
                    <h6>üõ†Ô∏è Steps:</h6>
                    <ol>
                        <li><strong>Determine faucet type:</strong> compression, cartridge, ball, or ceramic disk</li>
                        <li><strong>Check where the leak comes from:</strong> spout, base, or handle</li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Cartridge faucets are most common and easy to fix.
                    </div>
                `
            },
            {
                title: "Disassemble & Inspect",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI4MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIxNDAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxMCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjE1MCIgcj0iMTUiIGZpbGw9IiNmZjZiMzUiLz48Y2lyY2xlIGN4PSIzMDAiIGN5PSIxNTAiIHI9IjE1IiBmaWxsPSIjZjc5MzFlIi8+PHRleHQgeD0iMjAwIiB5PSIyNjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzM0M2E0MCI+RGlzYXNzZW1ibHkgJiBJbnNwZWN0aW9uPC90ZXh0Pjwvc3ZnPg==",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI4MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIxNDAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxMCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjE1MCIgcj0iMTUiIGZpbGw9IiNmZjZiMzUiLz48Y2lyY2xlIGN4PSIzMDAiIGN5PSIxNTAiIHI9IjE1IiBmaWxsPSIjZjc5MzFlIi8+PHRleHQgeD0iMjAwIiB5PSIyNjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzM0M2E0MCI+RGlzYXNzZW1ibHkgJiBJbnNwZWN0aW9uPC90ZXh0Pjwvc3ZnPg==" class="img-fluid rounded" alt="Faucet Disassembly">
                    </div>
                    <h6>üéØ Goal: Open up the faucet safely and locate the worn-out part</h6>
                    <h6>üõ†Ô∏è Steps:</h6>
                    <ol>
                        <li><strong>Shut off water supply</strong></li>
                        <li><strong>Plug drain with rag or stopper</strong></li>
                        <li><strong>Remove handle and cartridge or washer</strong></li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Take the part to the hardware store to match replacement.
                    </div>
                `
            },
            {
                title: "Replace & Reassemble",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI5MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIxMjAiIGZpbGw9IiMyOGE3NDUiIHJ4PSIxMCIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iMjUiIGZpbGw9IiNmZmZmZmYiLz48dGV4dCB4PSIyMDAiIHk9IjI1MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSIjMzQzYTQwIj5GaXhlZCBGYXVjZXQ8L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI5MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIxMjAiIGZpbGw9IiMyOGE3NDUiIHJ4PSIxMCIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iMjUiIGZpbGw9IiNmZmZmZmYiLz48dGV4dCB4PSIyMDAiIHk9IjI1MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSIjMzQzYTQwIj5GaXhlZCBGYXVjZXQ8L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Reassembled Faucet">
                    </div>
                    <h6>üéØ Goal: Install the new component and confirm it's leak-free</h6>
                    <h6>üõ†Ô∏è Steps:</h6>
                    <ol>
                        <li><strong>Insert new cartridge or washer</strong></li>
                        <li><strong>Tighten gently and reassemble</strong></li>
                        <li><strong>Turn water back on and test</strong></li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> A small dab of plumber's grease helps with longevity.
                    </div>
                `
            }
        ]
    },
    toilet: {
        title: "Toilet Running Water Fix",
        level: "Intermediate",
        lessons: [
            {
                title: "How a Toilet Works",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDA3YmZmIiByeD0iNSIvPjxjaXJjbGUgY3g9IjE1MCIgY3k9IjEyMCIgcj0iMTUiIGZpbGw9IiNmZjZiMzUiLz48Y2lyY2xlIGN4PSIyNTAiIGN5PSIxMjAiIHI9IjE1IiBmaWxsPSIjZjc5MzFlIi8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+VG9pbGV0IFRhbmsgUGFydHM8L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDA3YmZmIiByeD0iNSIvPjxjaXJjbGUgY3g9IjE1MCIgY3k9IjEyMCIgcj0iMTUiIGZpbGw9IiNmZjZiMzUiLz48Y2lyY2xlIGN4PSIyNTAiIGN5PSIxMjAiIHI9IjE1IiBmaWxsPSIjZjc5MzFlIi8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+VG9pbGV0IFRhbmsgUGFydHM8L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Toilet Tank Parts">
                    </div>
                    <h6>üéØ Goal: Understand how the tank, flapper, and fill valve work together</h6>
                    <h6>üõ†Ô∏è Key Components:</h6>
                    <ul>
                        <li><strong>Tank</strong> - Holds water for flushing</li>
                        <li><strong>Flapper</strong> - Rubber seal at tank bottom (orange circle)</li>
                        <li><strong>Fill Valve</strong> - Controls water entering tank (yellow circle)</li>
                        <li><strong>Float</strong> - Signals when tank is full</li>
                        <li><strong>Chain</strong> - Connects handle to flapper</li>
                    </ul>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> A worn flapper or misaligned float is often the culprit.
                    </div>
                `
            },
            {
                title: "Diagnose the Running Water",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZGM0MDQ1IiByeD0iNSIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iMjAiIGZpbGw9IiNmZjAwMDAiLz48dGV4dCB4PSIyMDAiIHk9IjI3MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5EaWFnbm9zaXMgVGVzdDwvdGV4dD48L3N2Zz4=",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZGM0MDQ1IiByeD0iNSIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iMjAiIGZpbGw9IiNmZjAwMDAiLz48dGV4dCB4PSIyMDAiIHk9IjI3MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5EaWFnbm9zaXMgVGVzdDwvdGV4dD48L3N2Zz4=" class="img-fluid rounded" alt="Food Coloring Test">
                    </div>
                    <h6>üéØ Goal: Find out if it's the flapper, fill valve, or overflow</h6>
                    <h6>üõ†Ô∏è Food Coloring Test:</h6>
                    <ol>
                        <li><strong>Drop food coloring in the tank</strong> (red circle shows coloring)</li>
                        <li><strong>Wait 5-10 minutes without flushing</strong></li>
                        <li><strong>Check the bowl</strong> - If colored water appears ‚Üí flapper is leaking</li>
                    </ol>
                    <div class="alert alert-info">
                        <strong>üîä Listen for Sounds:</strong> Constant hiss = fill valve problem, intermittent = flapper
                    </div>
                `
            },
            {
                title: "Replace Parts",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDA3YmZmIiByeD0iNSIvPjxyZWN0IHg9IjUwIiB5PSIzMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI2MCIgZmlsbD0iIzI4YTc0NSIgcng9IjgiLz48cGF0aCBkPSJNIDI1MCAzMCBMIDM1MCA5MCBMIDI1MCA5MCBaIiBmaWxsPSIjZmY2YjM1Ii8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+SW5zdGFsbCBOZXcgUGFydHM8L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTgwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDA3YmZmIiByeD0iNSIvPjxyZWN0IHg9IjUwIiB5PSIzMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI2MCIgZmlsbD0iIzI4YTc0NSIgcng9IjgiLz48cGF0aCBkPSJNIDI1MCAzMCBMIDM1MCA5MCBMIDI1MCA5MCBaIiBmaWxsPSIjZmY2YjM1Ii8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+SW5zdGFsbCBOZXcgUGFydHM8L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Installing New Parts">
                    </div>
                    <h6>üéØ Goal: Perform a quick hardware swap</h6>
                    <h6>üõ†Ô∏è Installation Steps:</h6>
                    <ol>
                        <li><strong>Turn off water at shutoff valve</strong> (green rectangle shows valve)</li>
                        <li><strong>Flush to drain tank</strong></li>
                        <li><strong>Replace flapper</strong> (hooks and chain) OR <strong>fill valve</strong> (orange triangle shows new part)</li>
                        <li><strong>Turn water back on and test</strong></li>
                    </ol>
                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è Important:</strong> Don't overtighten plastic components - they can crack.
                    </div>
                `
            },
            {
                title: "Fine-Tune Water Level",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTYwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMjBjOTk3IiByeD0iNSIvPjxsaW5lIHgxPSIxMDAiIHkxPSIxNDAiIHgyPSIzMDAiIHkyPSIxNDAiIHN0cm9rZT0iIzI4YTc0NSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtZGFzaGFycmF5PSI1LDUiLz48Y2lyY2xlIGN4PSIyODAiIGN5PSIxMjAiIHI9IjEyIiBmaWxsPSIjZmZjMTA3Ii8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+UGVyZmVjdCBXYXRlciBMZXZlbDwvdGV4dD48L3N2Zz4=",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjgwIiB5PSI2MCIgd2lkdGg9IjI0MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiNkZWUyZTYiIHJ4PSIxNSIvPjxyZWN0IHg9IjEwMCIgeT0iMTYwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMjBjOTk3IiByeD0iNSIvPjxsaW5lIHgxPSIxMDAiIHkxPSIxNDAiIHgyPSIzMDAiIHkyPSIxNDAiIHN0cm9rZT0iIzI4YTc0NSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtZGFzaGFycmF5PSI1LDUiLz48Y2lyY2xlIGN4PSIyODAiIGN5PSIxMjAiIHI9IjEyIiBmaWxsPSIjZmZjMTA3Ii8+PHRleHQgeD0iMjAwIiB5PSIyNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+UGVyZmVjdCBXYXRlciBMZXZlbDwvdGV4dD48L3N2Zz4=" class="img-fluid rounded" alt="Proper Water Level">
                    </div>
                    <h6>üéØ Goal: Prevent wasteful overfilling</h6>
                    <h6>üõ†Ô∏è Adjustment Steps:</h6>
                    <ol>
                        <li><strong>Check current water level</strong> - Should be 1" below overflow (dashed line)</li>
                        <li><strong>Adjust float arm or screw</strong> - Move yellow float up/down</li>
                        <li><strong>Test multiple flushes</strong> - Ensure consistent operation</li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Perfect Result:</strong> Water should fill to the green level and stop automatically.
                    </div>
                `
            }
        ]
    },
    drain: {
        title: "Unclog a Drain Safely",
        level: "Beginner",
        lessons: [
            {
                title: "Know the Signs & Tools",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iODAiIGZpbGw9IiNkZWUyZTYiIHN0cm9rZT0iIzM0M2E0MCIgc3Ryb2tlLXdpZHRoPSI0Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxyZWN0IHg9IjUwIiB5PSIyNTAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZmNmIzNSIgcng9IjUiLz48cmVjdCB4PSIxNDAiIHk9IjI1MCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjMjhhNzQ1IiByeD0iNSIvPjxyZWN0IHg9IjI1MCIgeT0iMjUwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmZjMTA3IiByeD0iNSIvPjx0ZXh0IHg9IjIwMCIgeT0iMjkwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiMzNDNhNDAiPkRyYWluIFRvb2xzPC90ZXh0Pjwvc3ZnPg==",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iODAiIGZpbGw9IiNkZWUyZTYiIHN0cm9rZT0iIzM0M2E0MCIgc3Ryb2tlLXdpZHRoPSI0Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxyZWN0IHg9IjUwIiB5PSIyNTAiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZmNmIzNSIgcng9IjUiLz48cmVjdCB4PSIxNDAiIHk9IjI1MCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjMjhhNzQ1IiByeD0iNSIvPjxyZWN0IHg9IjI1MCIgeT0iMjUwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjZmZjMTA3IiByeD0iNSIvPjx0ZXh0IHg9IjIwMCIgeT0iMjkwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiMzNDNhNDAiPkRyYWluIFRvb2xzPC90ZXh0Pjwvc3ZnPg==" class="img-fluid rounded" alt="Drain Tools">
                    </div>
                    <h6>üéØ Goal: Recognize a clogged drain and gather tools</h6>
                    <h6>üõ†Ô∏è Warning Signs:</h6>
                    <ul>
                        <li><strong>Slow drainage, bubbling, or bad smells</strong></li>
                        <li><strong>Water backing up in sink or tub</strong></li>
                    </ul>
                    <h6>üß∞ Safe Tools You'll Need:</h6>
                    <ul>
                        <li>Plunger (orange tool)</li>
                        <li>Drain snake (green tool)</li>
                        <li>Baking soda & vinegar (yellow tool)</li>
                        <li>Bucket for cleanup</li>
                    </ul>
                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è Avoid:</strong> Chemical drain cleaners damage pipes over time.
                    </div>
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Quick Quiz:</h6>
                        <p class="mb-2">Which is the safest method for unclogging a bathroom sink?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-1', 'wrong', 'Bleach is dangerous and can damage pipes.')">A) Bleach</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-1', 'correct', 'Correct! A drain snake physically removes blockages safely.')">B) Snake</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-1', 'wrong', 'Boiling saltwater can crack pipes and fixtures.')">C) Boiling saltwater</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('drain-quiz-1', 'wrong', 'Motor oil would create a much worse problem!')">D) Motor oil</button>
                        </div>
                        <div id="drain-quiz-1" class="mt-2" style="display: none;"></div>
                    </div>
                `
            },
            {
                title: "Plunge It First",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxyZWN0IHg9IjE4MCIgeT0iNTAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI4MCIgZmlsbD0iI2ZmNmIzNSIgcng9IjUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI2MCIgcj0iMjAiIGZpbGw9IiNmZjZiMzUiLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5QbHVuZ2luZyBUZWNobmlxdWU8L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxyZWN0IHg9IjE4MCIgeT0iNTAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI4MCIgZmlsbD0iI2ZmNmIzNSIgcng9IjUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI2MCIgcj0iMjAiIGZpbGw9IiNmZjZiMzUiLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5QbHVuZ2luZyBUZWNobmlxdWU8L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Plunging Technique">
                    </div>
                    <h6>üéØ Goal: Try the most basic fix first</h6>
                    <h6>üõ†Ô∏è Plunging Steps:</h6>
                    <ol>
                        <li><strong>Fill the sink slightly with water</strong> (blue circle shows water level)</li>
                        <li><strong>Cover overflow holes with a damp cloth</strong></li>
                        <li><strong>Use a cup plunger</strong> (orange tool) to push straight down in bursts</li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Keep the seal tight and use strong, rhythmic motions.
                    </div>
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Quick Quiz:</h6>
                        <p class="mb-2">What should you do before plunging a bathroom sink?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-2', 'wrong', 'Chemical cleaners should never be used with plunging.')">A) Use drain cleaner</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-2', 'correct', 'Correct! Covering overflow holes creates better suction.')">B) Cover overflow holes</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-2', 'wrong', 'Lubricant would make the problem worse.')">C) Spray lubricant</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('drain-quiz-2', 'wrong', 'Hot water alone won\\'t create the pressure needed.')">D) Flush with hot water</button>
                        </div>
                        <div id="drain-quiz-2" class="mt-2" style="display: none;"></div>
                    </div>
                `
            },
            {
                title: "Snake It Out",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxwYXRoIGQ9Ik0gMjAwIDEzMCBRIDIyMCAxNTAgMjAwIDE3MCBRIDE4MCAyMDAgMjAwIDIyMCIgc3Ryb2tlPSIjMjhhNzQ1IiBzdHJva2Utd2lkdGg9IjYiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSIyMjAiIHI9IjgiIGZpbGw9IiNkYzQwNDUiLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5EcmFpbiBTbmFrZSBpbiBBY3Rpb248L3RleHQ+PC9zdmc+",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxwYXRoIGQ9Ik0gMjAwIDEzMCBRIDIyMCAxNTAgMjAwIDE3MCBRIDE4MCAyMDAgMjAwIDIyMCIgc3Ryb2tlPSIjMjhhNzQ1IiBzdHJva2Utd2lkdGg9IjYiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSIyMjAiIHI9IjgiIGZpbGw9IiNkYzQwNDUiLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5EcmFpbiBTbmFrZSBpbiBBY3Rpb248L3RleHQ+PC9zdmc+" class="img-fluid rounded" alt="Drain Snake">
                    </div>
                    <h6>üéØ Goal: Physically remove the clog</h6>
                    <h6>üõ†Ô∏è Snake Steps:</h6>
                    <ol>
                        <li><strong>Slowly insert the snake down the drain</strong> (green wavy line)</li>
                        <li><strong>Rotate to snag hair or debris</strong> (red dot shows clog)</li>
                        <li><strong>Gently pull out and clean off</strong></li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Use a plastic zip snake for hair ‚Äî they're cheap and effective.
                    </div>
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Quick Quiz:</h6>
                        <p class="mb-2">What's the main goal of a drain snake?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-3', 'wrong', 'Snakes don\\'t melt anything - that\\'s chemicals.')">A) Melt gunk</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-3', 'wrong', 'Never push clogs deeper - that makes it worse!')">B) Push clogs deeper</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-3', 'correct', 'Correct! Snakes grab and pull out hair, soap, and debris.')">C) Pull out blockages</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('drain-quiz-3', 'wrong', 'Pressure is what plungers do, not snakes.')">D) Create pressure</button>
                        </div>
                        <div id="drain-quiz-3" class="mt-2" style="display: none;"></div>
                    </div>
                `
            },
            {
                title: "Natural Drain Bomb",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxjaXJjbGUgY3g9IjE2MCIgY3k9Ijk0IiByPSIxNSIgZmlsbD0iI2ZmYzEwNyIvPjxjaXJjbGUgY3g9IjI0MCIgY3k9Ijk0IiByPSIxNSIgZmlsbD0iI2ZmYzEwNyIvPjxjaXJjbGUgY3g9IjE4MCIgY3k9IjgwIiByPSI4IiBmaWxsPSIjMjBjOTk3Ii8+PGNpcmNsZSBjeD0iMjIwIiBjeT0iODAiIHI9IjgiIGZpbGw9IiMyMGM5OTciLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI3MCIgcj0iMTAiIGZpbGw9IiMyMGM5OTciLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5OYXR1cmFsIEZpenppbmcgQWN0aW9uPC90ZXh0Pjwvc3ZnPg==",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjEwMCIgeT0iMTIwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2RlZTJlNiIgcng9IjE1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTcwIiByPSI0MCIgZmlsbD0iIzAwN2JmZiIvPjxjaXJjbGUgY3g9IjE2MCIgY3k9Ijk0IiByPSIxNSIgZmlsbD0iI2ZmYzEwNyIvPjxjaXJjbGUgY3g9IjI0MCIgY3k9Ijk0IiByPSIxNSIgZmlsbD0iI2ZmYzEwNyIvPjxjaXJjbGUgY3g9IjE4MCIgY3k9IjgwIiByPSI4IiBmaWxsPSIjMjBjOTk3Ii8+PGNpcmNsZSBjeD0iMjIwIiBjeT0iODAiIHI9IjgiIGZpbGw9IiMyMGM5OTciLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI3MCIgcj0iMTAiIGZpbGw9IiMyMGM5OTciLz48dGV4dCB4PSIyMDAiIHk9IjI2MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzQzYTQwIj5OYXR1cmFsIEZpenppbmcgQWN0aW9uPC90ZXh0Pjwvc3ZnPg==" class="img-fluid rounded" alt="Baking Soda and Vinegar">
                    </div>
                    <h6>üéØ Goal: Use a safe bubbling solution</h6>
                    <h6>üõ†Ô∏è Natural Bomb Steps:</h6>
                    <ol>
                        <li><strong>Pour ¬Ω cup of baking soda into the drain</strong> (yellow circles)</li>
                        <li><strong>Add 1 cup of vinegar</strong> ‚Äî watch it fizz! (green bubbles)</li>
                        <li><strong>Cover for 10 minutes, then flush with hot water</strong></li>
                    </ol>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Monthly use keeps drains fresh and clear.
                    </div>
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Quick Quiz:</h6>
                        <p class="mb-2">What does vinegar do when combined with baking soda?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-4', 'correct', 'Correct! The reaction creates fizzing foam that helps break down gunk.')">A) Makes cleaning foam</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-4', 'wrong', 'Vinegar and baking soda don\\'t damage metal pipes.')">B) Eats metal</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drain-quiz-4', 'wrong', 'This combination doesn\\'t release bleach.')">C) Releases bleach</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('drain-quiz-4', 'wrong', 'Water pressure comes from plumbing, not chemical reactions.')">D) Neutralizes pressure</button>
                        </div>
                        <div id="drain-quiz-4" class="mt-2" style="display: none;"></div>
                    </div>
                `
            }
        ]
    },
    drywall: {
        title: "Patch Drywall",
        level: "Beginner",
        lessons: [
            {
                title: "Assess the Damage",
                image: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI1MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzM0M2E0MCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGNpcmNsZSBjeD0iMTIwIiBjeT0iMTIwIiByPSI1IiBmaWxsPSIjZGM0MDQ1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSIxNSIgZmlsbD0iI2ZmNmIzNSIvPjxyZWN0IHg9IjI2MCIgeT0iMTAwIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9IiMyOGE3NDUiIHJ4PSI1Ii8+PHRleHQgeD0iMjAwIiB5PSIyODAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+RGFtYWdlIFNpemVzPC90ZXh0Pjwvc3ZnPg==",
                content: `
                    <div class="lesson-visual mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjxyZWN0IHg9IjUwIiB5PSI1MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzM0M2E0MCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGNpcmNsZSBjeD0iMTIwIiBjeT0iMTIwIiByPSI1IiBmaWxsPSIjZGM0MDQ1Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSIxNSIgZmlsbD0iI2ZmNmIzNSIvPjxyZWN0IHg9IjI2MCIgeT0iMTAwIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9IiMyOGE3NDUiIHJ4PSI1Ii8+PHRleHQgeD0iMjAwIiB5PSIyODAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzM0M2E0MCI+RGFtYWdlIFNpemVzPC90ZXh0Pjwvc3ZnPg==" class="img-fluid rounded" alt="Different Damage Sizes">
                    </div>
                    <h6>üéØ Goal: Know what type of repair you need</h6>
                    <h6>üõ†Ô∏è Damage Types:</h6>
                    <ul>
                        <li><strong>Small:</strong> Nail/screw holes (red dot) - pencil eraser-sized</li>
                        <li><strong>Medium:</strong> Anchor holes (orange circle) - quarter-sized</li>
                        <li><strong>Large:</strong> Cut out sections (green square) - fist-sized damage</li>
                    </ul>
                    <div class="alert alert-success">
                        <strong>‚úÖ Pro Tip:</strong> Pencil eraser-sized holes can be patched in minutes.
                    </div>
                    <div class="mt-3 p-3 bg-primary text-white rounded">
                        <h6>üìå Quick Quiz:</h6>
                        <p class="mb-2">Which damage type needs a wallboard patch and mesh tape?</p>
                        <div class="quiz-options">
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drywall-quiz-1', 'wrong', 'Nail holes just need spackle.')">A) Nail hole</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drywall-quiz-1', 'wrong', 'Paint bubbles need scraping, not patches.')">B) Paint bubble</button>
                            <button class="btn btn-warning btn-sm me-2" onclick="showQuizAnswer('drywall-quiz-1', 'correct', 'Correct! Large holes need proper backing and mesh tape for strength.')">C) Large hole</button>
                            <button class="btn btn-warning btn-sm" onclick="showQuizAnswer('drywall-quiz-1', 'wrong', 'Screw pops just need re-screwing and touch-up.')">D) Screw pop</button>
                        </div>
                        <div id="drywall-quiz-1" class="mt-2" style="display: none;"></div>
                    </div>
                `
            }
        ]
    }
};

// JavaScript functionality
let currentCourse = null;
let currentLesson = 0;

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    console.log('SPANK School loaded successfully');
});

// Smooth scroll to courses
function scrollToCourses() {
    document.getElementById('courses').scrollIntoView({ behavior: 'smooth' });
}

// Start a course
function startCourse(courseId) {
    currentCourse = courses[courseId];
    if (!currentCourse) {
        alert('Course content coming soon! SPANK is developing comprehensive guides for all repairs.');
        return;
    }
    
    currentLesson = 0;
    showLesson();
}

// Show current lesson with visual guide
function showLesson() {
    if (!currentCourse || currentLesson >= currentCourse.lessons.length) return;
    
    const lesson = currentCourse.lessons[currentLesson];
    const modal = new bootstrap.Modal(document.getElementById('courseModal'));
    
    document.getElementById('courseModalTitle').innerHTML = `
        ${currentCourse.title} - Step ${currentLesson + 1} of ${currentCourse.lessons.length}
        <small class="text-muted d-block">${lesson.title}</small>
    `;
    
    // Create lesson content with navigation
    const lessonContent = `
        <div class="lesson-container">
            <div class="lesson-progress mb-3">
                <div class="progress" style="height: 8px;">
                    <div class="progress-bar bg-warning" style="width: ${((currentLesson + 1) / currentCourse.lessons.length) * 100}%"></div>
                </div>
                <small class="text-muted">Step ${currentLesson + 1} of ${currentCourse.lessons.length}</small>
            </div>
            
            <div class="lesson-content">
                ${lesson.content}
            </div>
            
            <div class="lesson-navigation mt-4 d-flex justify-content-between">
                <button class="btn btn-outline-secondary" onclick="previousLesson()" ${currentLesson === 0 ? 'disabled' : ''}>
                    <i class="fas fa-arrow-left me-2"></i>Previous
                </button>
                
                <div class="lesson-indicators">
                    ${currentCourse.lessons.map((_, index) => 
                        `<span class="badge ${index === currentLesson ? 'bg-warning' : 'bg-light'} me-1">${index + 1}</span>`
                    ).join('')}
                </div>
                
                <button class="btn btn-primary" onclick="${currentLesson < currentCourse.lessons.length - 1 ? 'nextLesson()' : 'completeCourse()'}">
                    ${currentLesson < currentCourse.lessons.length - 1 ? 'Next <i class="fas fa-arrow-right ms-2"></i>' : 'Complete <i class="fas fa-check ms-2"></i>'}
                </button>
            </div>
        </div>
    `;
    
    document.getElementById('courseModalBody').innerHTML = lessonContent;
    
    // Update modal footer
    const nextBtn = document.getElementById('nextLessonBtn');
    nextBtn.style.display = 'none'; // Hide default button since we have custom navigation
    
    // Initialize interactive elements for toolbelt course
    modal.show();
    
    // Add slight delay to ensure DOM elements are rendered
    setTimeout(() => {
        if (currentCourse === courses.toolbelt) {
            if (currentLesson === 0) {
                initToolMatchingGame();
            } else if (currentLesson === 1) {
                initToolbeltSimulator();
            } else if (currentLesson === 2) {
                initToolboxOrganizer();
            }
        }
    }, 200);
}

// Previous lesson function
function previousLesson() {
    if (currentLesson > 0) {
        currentLesson--;
        showLesson();
    }
}

// Next lesson
function nextLesson() {
    currentLesson++;
    showLesson();
}

// Enhanced course completion with SMS rewards
function completeCourse(courseType = null) {
    if (document.getElementById('courseModal')) {
        bootstrap.Modal.getInstance(document.getElementById('courseModal')).hide();
    }
    
    setTimeout(() => {
        // Enhanced completion popup
        const completionModal = document.createElement('div');
        completionModal.className = 'modal fade';
        completionModal.innerHTML = `
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-body text-center p-5">
                        <div class="celebration-animation mb-4">
                            <i class="fas fa-trophy fa-4x text-warning mb-3" style="animation: bounce 1s ease infinite;"></i>
                            <h3 class="text-success mb-3">Congratulations!</h3>
                            <p class="lead">You've completed the ${courseType ? courseType.charAt(0).toUpperCase() + courseType.slice(1) : currentCourse?.title || 'DIY'} course!</p>
                        </div>
                        
                        <div class="reward-section p-4 bg-light rounded mb-4">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-coins me-2"></i>Claim Your $5 SPANK Bucks
                            </h5>
                            <form id="rewardForm">
                                <div class="mb-3">
                                    <label for="studentName" class="form-label">Your Name</label>
                                    <input type="text" class="form-control" id="studentName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="studentPhone" class="form-label">Phone Number (for SMS reward)</label>
                                    <input type="tel" class="form-control" id="studentPhone" placeholder="(808) 555-0123" required>
                                </div>
                                <div class="mb-3">
                                    <label for="studentEmail" class="form-label">Email (optional)</label>
                                    <input type="email" class="form-control" id="studentEmail">
                                </div>
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    Your $5 SPANK Bucks will be sent via SMS, and our team will follow up to help with your project!
                                </div>
                            </form>
                        </div>
                        
                        <div class="d-flex gap-2 justify-content-center">
                            <button type="button" class="btn btn-outline-secondary" onclick="closeCompletionModal()">
                                Maybe Later
                            </button>
                            <button type="button" class="btn btn-success btn-lg" onclick="submitCourseCompletion('${courseType}')">
                                <i class="fas fa-gift me-2"></i>Claim Reward
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        document.body.appendChild(completionModal);
        const modal = new bootstrap.Modal(completionModal);
        modal.show();
        
        // Add confetti effect
        createCelebrationEffect();
        
        // Cleanup
        completionModal.addEventListener('hidden.bs.modal', () => {
            document.body.removeChild(completionModal);
        });
        
        // Store modal reference for cleanup
        window.currentCompletionModal = completionModal;
    }, 500);
}

function submitCourseCompletion(courseType) {
    const name = document.getElementById('studentName').value;
    const phone = document.getElementById('studentPhone').value;
    const email = document.getElementById('studentEmail').value;
    
    if (!name || !phone) {
        alert('Please enter your name and phone number to receive your SPANK Buck reward.');
        return;
    }
    
    const courseName = courseType ? `${courseType.charAt(0).toUpperCase() + courseType.slice(1)} Repair` : currentCourse?.title || 'DIY Course';
    
    // Show loading state
    const submitBtn = event.target;
    const originalText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending Reward...';
    submitBtn.disabled = true;
    
    // Send SPANK Buck reward via API
    fetch('/api/complete-course', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            student_name: name,
            phone: phone,
            email: email,
            course_name: courseName
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Success message
            document.querySelector('.modal-body').innerHTML = `
                <div class="text-center p-4">
                    <i class="fas fa-check-circle fa-4x text-success mb-3" style="animation: bounce 1s ease;"></i>
                    <h3 class="text-success mb-3">Reward Sent!</h3>
                    <p class="lead mb-4">$5 SPANK Bucks have been sent to ${phone}</p>
                    <div class="alert alert-success">
                        <i class="fas fa-phone me-2"></i>
                        Our SPANK team will reach out soon to help with your project!
                    </div>
                    <button class="btn btn-primary" onclick="closeCompletionModal()">
                        <i class="fas fa-thumbs-up me-2"></i>Awesome!
                    </button>
                </div>
            `;
        } else {
            throw new Error(data.error || 'Failed to send reward');
        }
    })
    .catch(error => {
        console.error('Error sending SPANK Buck reward:', error);
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        alert('Course completed! However, there was an issue sending your SPANK Bucks. Please contact us at (808) 778-9132 and mention you completed the course.');
    });
}

function closeCompletionModal() {
    if (window.currentCompletionModal) {
        bootstrap.Modal.getInstance(window.currentCompletionModal).hide();
    }
}

function createCelebrationEffect() {
    const colors = ['#ffc107', '#28a745', '#007bff', '#dc3545', '#6f42c1', '#fd7e14'];
    
    for (let i = 0; i < 30; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
            position: fixed;
            width: 8px;
            height: 8px;
            background: ${colors[Math.floor(Math.random() * colors.length)]};
            top: -10px;
            left: ${Math.random() * 100}vw;
            border-radius: 50%;
            animation: confettiFall ${2 + Math.random() * 2}s ease-out forwards;
            pointer-events: none;
            z-index: 9999;
        `;
        document.body.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 4000);
    }
}

// Send SPANK Bucks reward
function sendSpankBucks(email, amount, reason) {
    // In a real implementation, this would integrate with email service
    console.log(`Sending $${amount} SPANK Bucks to ${email} for: ${reason}`);
    return true;
}

// Enhanced interactive functions
function showAnswer(quizId, answer) {
    const element = document.getElementById(quizId);
    if (element) {
        element.innerHTML = `<div class="alert alert-light mt-2"><strong>Answer:</strong> ${answer}</div>`;
        element.style.display = 'block';
    }
}

function showEnhancedAnswer(quizId, answer) {
    const element = document.getElementById(quizId);
    if (element) {
        element.innerHTML = `
            <div class="alert alert-light border-0 shadow-sm mt-3">
                <div class="d-flex align-items-start">
                    <i class="fas fa-check-circle text-success fa-lg me-3 mt-1"></i>
                    <div>
                        <h6 class="mb-1 text-success">Great Question!</h6>
                        <p class="mb-0">${answer}</p>
                    </div>
                </div>
            </div>
        `;
        element.style.display = 'block';
        element.style.animation = 'slideInUp 0.5s ease forwards';
        
        // Add confetti effect
        createConfetti(element);
    }
}

function createConfetti(container) {
    for (let i = 0; i < 10; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
            position: absolute;
            width: 6px;
            height: 6px;
            background: ${['#ffc107', '#28a745', '#007bff', '#dc3545'][Math.floor(Math.random() * 4)]};
            top: 0;
            left: ${Math.random() * 100}%;
            border-radius: 50%;
            animation: confettiFall 2s ease-out forwards;
            pointer-events: none;
        `;
        container.style.position = 'relative';
        container.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 2000);
    }
}

function watchVideo(videoId) {
    const modal = new bootstrap.Modal(document.getElementById('courseModal'));
    document.getElementById('courseModalTitle').textContent = 'SPANK Video Tutorial';
    document.getElementById('courseModalBody').innerHTML = `
        <div class="text-center">
            <div class="alert alert-info">
                <h6><i class="fas fa-video me-2"></i>Professional Video Tutorial</h6>
                <p class="mb-2">Learn with SPANK's expert demonstration</p>
                <p><strong>Coming Soon:</strong> Full video library with step-by-step repairs</p>
            </div>
            <div class="mb-3">
                <p>This video covers professional techniques and safety tips.</p>
            </div>
            <button class="btn btn-primary" onclick="window.open('tel:(808)778-9132')">
                Call SPANK for Professional Service
            </button>
        </div>
    `;
    document.getElementById('nextLessonBtn').textContent = 'Close';
    document.getElementById('nextLessonBtn').onclick = () => {
        bootstrap.Modal.getInstance(document.getElementById('courseModal')).hide();
    };
    modal.show();
}

function startTroubleshooter() {
    alert('Interactive Problem Solver coming soon! This will guide you through diagnosing common home issues step-by-step.');
}

function startQuiz() {
    const email = prompt('Take our DIY Knowledge Quiz!\n\nEnter your email to receive $5 SPANK Bucks upon completion:');
    if (email && email.includes('@')) {
        alert(`Great! Complete the quiz and your $5 SPANK Bucks will be emailed to ${email} within 24 hours.`);
        // Quiz implementation would go here
        console.log(`Send $5 SPANK Bucks to: ${email} for completing quiz`);
    }
}

function joinLiveSession() {
    alert('Live Q&A sessions coming soon! Join weekly sessions with SPANK experts to get your questions answered.');
}

// Enhanced quiz functionality for interactive courses
function showQuizAnswer(quizId, result, explanation) {
    const element = document.getElementById(quizId);
    if (element) {
        const alertClass = result === 'correct' ? 'alert-success' : 'alert-danger';
        const icon = result === 'correct' ? '‚úì' : '‚úó';
        element.innerHTML = `<div class="alert ${alertClass} mt-2"><strong>${icon} ${explanation}</strong></div>`;
        element.style.display = 'block';
        
        // Award points for correct answers
        if (result === 'correct') {
            updatePoints(2);
        }
    }
}

// Knowledge Quiz System
const knowledgeQuiz = {
    questions: [
        {
            question: "What's the first thing you should do before replacing a light switch?",
            options: ["Remove the wall plate", "Test the new switch", "Turn off the power", "Grab a hammer"],
            correct: 2,
            explanation: "Always shut off power at the breaker before touching electrical components."
        },
        {
            question: "What tool helps you detect a stud behind drywall?",
            options: ["Tape measure", "Stud finder", "Level", "Flashlight"],
            correct: 1,
            explanation: "Stud finders use sensors to locate wooden framing behind walls."
        },
        {
            question: "What's a good replacement for caulk that has cracked along the tub?",
            options: ["Duct tape", "Fresh caulk", "Paint", "Silicone spray"],
            correct: 1,
            explanation: "Recaulking is the proper way to reseal a tub or sink joint."
        },
        {
            question: "What color is typically used for the 'hot' electrical wire?",
            options: ["Green", "White", "Black or red", "Blue"],
            correct: 2,
            explanation: "Black or red wires carry current in most home circuits."
        },
        {
            question: "What's the purpose of primer before painting a patched wall?",
            options: ["Makes the paint dry faster", "Hides the patch and improves paint adhesion", "Adds shine", "Makes it washable"],
            correct: 1,
            explanation: "Primer seals spackle and ensures even color coverage."
        }
    ],
    currentQuestion: 0,
    score: 0,
    answers: []
};

function startKnowledgeQuiz() {
    knowledgeQuiz.currentQuestion = 0;
    knowledgeQuiz.score = 0;
    knowledgeQuiz.answers = [];
    
    const modal = new bootstrap.Modal(document.getElementById('knowledgeQuizModal'));
    showQuizQuestion();
    modal.show();
}

function showQuizQuestion() {
    const quiz = knowledgeQuiz;
    const question = quiz.questions[quiz.currentQuestion];
    
    const content = `
        <div class="quiz-header mb-4">
            <div class="progress mb-3">
                <div class="progress-bar bg-warning" style="width: ${((quiz.currentQuestion + 1) / quiz.questions.length) * 100}%"></div>
            </div>
            <h6 class="text-muted">Question ${quiz.currentQuestion + 1} of ${quiz.questions.length}</h6>
        </div>
        
        <div class="quiz-question mb-4">
            <h5 class="mb-4">${question.question}</h5>
            <div class="quiz-options">
                ${question.options.map((option, index) => `
                    <button class="btn btn-outline-primary w-100 mb-2 quiz-option" 
                            onclick="selectQuizAnswer(${index})" 
                            data-option="${index}">
                        ${String.fromCharCode(65 + index)}) ${option}
                    </button>
                `).join('')}
            </div>
        </div>
        
        <div id="quiz-feedback" class="mb-3" style="display: none;"></div>
    `;
    
    document.getElementById('quizContent').innerHTML = content;
    document.getElementById('quizActionBtn').textContent = 'Next Question';
    document.getElementById('quizActionBtn').onclick = nextQuizQuestion;
}

function selectQuizAnswer(selectedIndex) {
    const quiz = knowledgeQuiz;
    const question = quiz.questions[quiz.currentQuestion];
    const isCorrect = selectedIndex === question.correct;
    
    // Store answer
    quiz.answers.push(selectedIndex);
    if (isCorrect) quiz.score++;
    
    // Show feedback
    const feedback = document.getElementById('quiz-feedback');
    const icon = isCorrect ? '‚úì' : '‚úó';
    const alertClass = isCorrect ? 'alert-success' : 'alert-danger';
    
    feedback.innerHTML = `
        <div class="alert ${alertClass}">
            <strong>${icon} ${isCorrect ? 'Correct!' : 'Incorrect'}</strong>
            <p class="mb-0 mt-2">${question.explanation}</p>
        </div>
    `;
    feedback.style.display = 'block';
    
    // Disable all option buttons
    document.querySelectorAll('.quiz-option').forEach(btn => {
        btn.disabled = true;
        if (parseInt(btn.dataset.option) === question.correct) {
            btn.classList.add('btn-success');
            btn.classList.remove('btn-outline-primary');
        } else if (parseInt(btn.dataset.option) === selectedIndex && !isCorrect) {
            btn.classList.add('btn-danger');
            btn.classList.remove('btn-outline-primary');
        }
    });
}

function nextQuizQuestion() {
    const quiz = knowledgeQuiz;
    
    if (quiz.currentQuestion < quiz.questions.length - 1) {
        quiz.currentQuestion++;
        showQuizQuestion();
    } else {
        showQuizResults();
    }
}

function showQuizResults() {
    const quiz = knowledgeQuiz;
    const passed = quiz.score >= 4;
    const percentage = Math.round((quiz.score / quiz.questions.length) * 100);
    
    const content = `
        <div class="text-center">
            <div class="quiz-result-icon mb-4">
                <i class="fas fa-${passed ? 'trophy' : 'redo'} fa-4x text-${passed ? 'warning' : 'muted'}"></i>
            </div>
            
            <h3 class="mb-3">${passed ? 'Congratulations!' : 'Almost There!'}</h3>
            <h4 class="mb-4">You scored ${quiz.score} out of ${quiz.questions.length} (${percentage}%)</h4>
            
            ${passed ? `
                <div class="alert alert-success">
                    <h5><i class="fas fa-dollar-sign me-2"></i>You've earned $5 SPANK Bucks!</h5>
                    <p class="mb-0">Check your email for your reward confirmation.</p>
                </div>
            ` : `
                <div class="alert alert-info">
                    <h6>Review SPANK School lessons and try again next week!</h6>
                    <p class="mb-0">You need 4 or more correct answers to earn SPANK Bucks.</p>
                </div>
            `}
            
            <div class="mt-4">
                <h6>Your Answers:</h6>
                ${quiz.questions.map((q, index) => {
                    const userAnswer = quiz.answers[index];
                    const isCorrect = userAnswer === q.correct;
                    return `
                        <div class="text-start mb-2">
                            <small class="text-muted">Q${index + 1}: ${q.question}</small><br>
                            <span class="badge bg-${isCorrect ? 'success' : 'danger'} me-2">
                                ${isCorrect ? '‚úì' : '‚úó'}
                            </span>
                            Your answer: ${q.options[userAnswer]}
                            ${!isCorrect ? `<br><small class="text-success">Correct: ${q.options[q.correct]}</small>` : ''}
                        </div>
                    `;
                }).join('')}
            </div>
        </div>
    `;
    
    document.getElementById('quizContent').innerHTML = content;
    document.getElementById('quizActionBtn').textContent = 'Close';
    document.getElementById('quizActionBtn').onclick = () => {
        bootstrap.Modal.getInstance(document.getElementById('knowledgeQuizModal')).hide();
    };
    
    // Send reward email if passed
    if (passed) {
        sendQuizReward();
    }
}

function sendQuizReward() {
    // Send SPANK Bucks reward email
    const email = prompt('Enter your email to receive $5 SPANK Bucks:');
    if (email) {
        console.log(`Send $5 SPANK Bucks to: ${email} for passing knowledge quiz`);
        alert('Congratulations! Your $5 SPANK Bucks reward has been sent to your email.');
    }
}

// Problem Solver System
const problemSolver = {
    problems: [
        {
            title: "Faucet Won't Stop Dripping",
            icon: "fas fa-tint",
            steps: [
                {
                    question: "Where is it leaking from?",
                    options: [
                        { text: "Tip of the spout", next: "spout_leak" },
                        { text: "Base of handle", next: "handle_leak" }
                    ]
                }
            ],
            solutions: {
                spout_leak: {
                    title: "Spout Leak Solution",
                    content: "Likely a worn cartridge or washer. Turn off water valves under sink, remove handle, and replace the cartridge or washer.",
                    callSpank: "Still leaking? You may have a cracked valve seat."
                },
                handle_leak: {
                    title: "Handle Leak Solution", 
                    content: "Likely a loose packing nut or o-ring. Tighten the packing nut or replace the o-ring around the stem.",
                    callSpank: "Still leaking? The valve stem may need replacement."
                }
            }
        },
        {
            title: "Toilet Keeps Running",
            icon: "fas fa-toilet",
            steps: [
                {
                    question: "Open the tank. What do you see?",
                    options: [
                        { text: "Water level too high", next: "high_water" },
                        { text: "Flapper not sealing", next: "flapper_issue" },
                        { text: "Fill valve hissing", next: "fill_valve" }
                    ]
                }
            ],
            solutions: {
                high_water: {
                    title: "High Water Level Fix",
                    content: "Adjust the float height by bending the float arm down or adjusting the screw on newer fill valves.",
                    callSpank: "Still running? Your overflow pipe may be damaged."
                },
                flapper_issue: {
                    title: "Flapper Replacement",
                    content: "Turn off water, flush to empty tank, and replace the rubber flapper. Make sure the chain has proper slack.",
                    callSpank: "Still running? The flush valve seat may be warped."
                },
                fill_valve: {
                    title: "Fill Valve Replacement",
                    content: "Turn off water, disconnect supply line, and replace the entire fill valve assembly.",
                    callSpank: "Still running? You may have mineral buildup in the system."
                }
            }
        },
        {
            title: "Outlet Isn't Working",
            icon: "fas fa-plug",
            steps: [
                {
                    question: "Try a different device in the outlet. What happens?",
                    options: [
                        { text: "Still doesn't work", next: "outlet_dead" },
                        { text: "Works fine now", next: "device_issue" }
                    ]
                }
            ],
            solutions: {
                outlet_dead: {
                    title: "Dead Outlet Troubleshooting",
                    content: "Check circuit breaker (flip OFF then ON) and look for GFCI reset button. Test with voltage tester if you have one.",
                    callSpank: "Still no power? You need safe outlet replacement or wiring repair."
                },
                device_issue: {
                    title: "Device Problem",
                    content: "The original device was faulty, not the outlet. Try the device in other outlets to confirm.",
                    callSpank: "Device works elsewhere? The outlet may have loose connections."
                }
            }
        }
    ]
};

function showProblemSolver() {
    const modal = new bootstrap.Modal(document.getElementById('problemSolverModal'));
    showProblemList();
    modal.show();
}

function showProblemList() {
    const content = `
        <div class="problem-solver-intro mb-4">
            <h4>üõ†Ô∏è What's Your Home Repair Problem?</h4>
            <p class="text-muted">Select your issue below for step-by-step troubleshooting guidance.</p>
        </div>
        
        <div class="problem-list">
            ${problemSolver.problems.map((problem, index) => `
                <div class="card mb-3 problem-card" onclick="startProblemSolving(${index})">
                    <div class="card-body d-flex align-items-center">
                        <div class="problem-icon me-3">
                            <i class="${problem.icon} fa-2x text-primary"></i>
                        </div>
                        <div>
                            <h6 class="mb-1">${problem.title}</h6>
                            <small class="text-muted">Click for step-by-step guidance</small>
                        </div>
                        <div class="ms-auto">
                            <i class="fas fa-chevron-right text-muted"></i>
                        </div>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
    
    document.getElementById('problemSolverContent').innerHTML = content;
}

function startProblemSolving(problemIndex) {
    const problem = problemSolver.problems[problemIndex];
    const firstStep = problem.steps[0];
    
    const content = `
        <div class="problem-header mb-4">
            <div class="d-flex align-items-center mb-3">
                <button class="btn btn-outline-secondary btn-sm me-3" onclick="showProblemList()">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <h5 class="mb-0">${problem.title}</h5>
            </div>
        </div>
        
        <div class="problem-step">
            <h6 class="mb-3">${firstStep.question}</h6>
            <div class="step-options">
                ${firstStep.options.map(option => `
                    <button class="btn btn-outline-primary w-100 mb-2" 
                            onclick="showSolution('${option.next}', ${problemIndex})">
                        ${option.text}
                    </button>
                `).join('')}
            </div>
        </div>
    `;
    
    document.getElementById('problemSolverContent').innerHTML = content;
}

function showSolution(solutionKey, problemIndex) {
    const problem = problemSolver.problems[problemIndex];
    const solution = problem.solutions[solutionKey];
    
    const content = `
        <div class="solution-header mb-4">
            <div class="d-flex align-items-center mb-3">
                <button class="btn btn-outline-secondary btn-sm me-3" onclick="startProblemSolving(${problemIndex})">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <h5 class="mb-0">${solution.title}</h5>
            </div>
        </div>
        
        <div class="solution-content">
            <div class="alert alert-info">
                <h6><i class="fas fa-tools me-2"></i>What to do:</h6>
                <p class="mb-0">${solution.content}</p>
            </div>
            
            <div class="alert alert-warning">
                <h6><i class="fas fa-exclamation-triangle me-2"></i>Still having trouble?</h6>
                <p class="mb-0">${solution.callSpank}</p>
            </div>
            
            <div class="text-center mt-4">
                <button class="btn btn-warning btn-lg" onclick="window.location.href='/contact'">
                    <i class="fas fa-phone me-2"></i>Call SPANK for Professional Help
                </button>
            </div>
        </div>
    `;
    
    document.getElementById('problemSolverContent').innerHTML = content;
}

// Interactive Toolbelt Course Functions
let toolbeltState = {
    selectedSlot: null,
    filledSlots: 0,
    maxSlots: 6
};

// Initialize interactive elements when course modal opens
document.addEventListener('DOMContentLoaded', function() {
    // Tool matching game initialization will happen when course loads
});

// Tool Matching Game for Lesson 1
function initToolMatchingGame() {
    const toolItems = document.querySelectorAll('.tool-item');
    const taskZones = document.querySelectorAll('.task-zone');
    
    toolItems.forEach(item => {
        item.addEventListener('dragstart', handleDragStart);
        item.addEventListener('dragend', handleDragEnd);
    });
    
    taskZones.forEach(zone => {
        zone.addEventListener('dragover', handleDragOver);
        zone.addEventListener('drop', handleDrop);
        zone.addEventListener('dragenter', handleDragEnter);
        zone.addEventListener('dragleave', handleDragLeave);
    });
}

function handleDragStart(e) {
    e.dataTransfer.setData('text/plain', e.target.dataset.tool);
    e.target.classList.add('dragging');
}

function handleDragEnd(e) {
    e.target.classList.remove('dragging');
}

function handleDragOver(e) {
    e.preventDefault();
}

function handleDragEnter(e) {
    e.preventDefault();
    e.target.classList.add('drag-over');
}

function handleDragLeave(e) {
    e.target.classList.remove('drag-over');
}

function handleDrop(e) {
    e.preventDefault();
    const toolType = e.dataTransfer.getData('text/plain');
    const taskType = e.target.dataset.task;
    
    e.target.classList.remove('drag-over');
    
    if (toolType === taskType) {
        e.target.classList.add('correct');
        e.target.innerHTML = `‚úì Correct! ${e.target.innerHTML}`;
        
        // Find and hide the dragged tool
        const draggedTool = document.querySelector(`[data-tool="${toolType}"]`);
        if (draggedTool) {
            draggedTool.style.display = 'none';
        }
    } else {
        // Show incorrect feedback
        e.target.style.background = '#f8d7da';
        e.target.style.borderColor = '#dc3545';
        setTimeout(() => {
            e.target.style.background = '#e9ecef';
            e.target.style.borderColor = '#adb5bd';
        }, 1000);
    }
}

// Toolbelt Simulator for Lesson 2
function initToolbeltSimulator() {
    const toolChoices = document.querySelectorAll('.tool-choice');
    const slots = document.querySelectorAll('.slot');
    
    toolChoices.forEach(choice => {
        choice.addEventListener('click', function() {
            if (this.classList.contains('selected')) {
                // Deselect tool
                this.classList.remove('selected');
                toolbeltState.selectedSlot = null;
            } else if (toolbeltState.filledSlots < toolbeltState.maxSlots) {
                // Select tool
                toolChoices.forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                
                // Find first empty slot and fill it
                const emptySlot = document.querySelector('.slot.empty');
                if (emptySlot) {
                    emptySlot.classList.remove('empty');
                    emptySlot.classList.add('filled');
                    emptySlot.innerHTML = this.innerHTML;
                    emptySlot.dataset.tool = this.dataset.tool;
                    
                    toolbeltState.filledSlots++;
                    this.style.opacity = '0.5';
                    this.style.pointerEvents = 'none';
                }
                
                this.classList.remove('selected');
            }
        });
    });
    
    slots.forEach(slot => {
        slot.addEventListener('click', function() {
            if (this.classList.contains('filled')) {
                // Remove tool from slot
                const toolType = this.dataset.tool;
                this.classList.remove('filled');
                this.classList.add('empty');
                this.innerHTML = `Slot ${this.dataset.slot}`;
                this.removeAttribute('data-tool');
                
                // Re-enable tool choice
                const toolChoice = document.querySelector(`[data-tool="${toolType}"]`);
                if (toolChoice) {
                    toolChoice.style.opacity = '1';
                    toolChoice.style.pointerEvents = 'auto';
                }
                
                toolbeltState.filledSlots--;
            }
        });
    });
}

// Toolbox Organizer for Lesson 3
function initToolboxOrganizer() {
    const scatteredTools = document.querySelectorAll('.scattered-tool');
    const trayZones = document.querySelectorAll('.tray-zone');
    
    scatteredTools.forEach(tool => {
        tool.addEventListener('dragstart', function(e) {
            e.dataTransfer.setData('text/plain', this.dataset.tool);
            this.style.opacity = '0.5';
        });
        
        tool.addEventListener('dragend', function(e) {
            this.style.opacity = '1';
        });
    });
    
    trayZones.forEach(zone => {
        zone.addEventListener('dragover', function(e) {
            e.preventDefault();
        });
        
        zone.addEventListener('drop', function(e) {
            e.preventDefault();
            const toolType = e.dataTransfer.getData('text/plain');
            const draggedTool = document.querySelector(`[data-tool="${toolType}"]`);
            
            if (draggedTool) {
                // Create organized tool element
                const organizedTool = document.createElement('div');
                organizedTool.innerHTML = draggedTool.innerHTML;
                organizedTool.style.background = '#28a745';
                organizedTool.style.color = 'white';
                organizedTool.style.padding = '5px 10px';
                organizedTool.style.borderRadius = '4px';
                organizedTool.style.margin = '2px';
                organizedTool.style.display = 'inline-block';
                
                this.appendChild(organizedTool);
                draggedTool.remove();
            }
        });
    });
}
</script>
{% endblock %}